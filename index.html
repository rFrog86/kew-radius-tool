<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Kew Gardens Radius Tool</title>
  <style>
    body { text-align: center; font-family: Arial; }
    canvas { border: 1px solid #ccc; cursor: crosshair; max-width: 100%; height: auto; }
    #controls { margin: 10px 0; }
  </style>
</head>
<body>
  <h2>RBG Kew Gardens Radius Tool</h2>

  <div id="controls">
    <label for="radiusInput">Radius (meters):</label>
    <input type="number" id="radiusInput" value="50" min="1" />
    
    <label for="colorSelect">Color:</label>
    <select id="colorSelect">
      <option value="red">Red</option>
      <option value="green">Green</option>
    </select>

    <label for="modeSelect">Mode:</label>
    <select id="modeSelect">
      <option value="circle">Circle</option>
      <option value="line">Line</option>
    </select>

    <button onclick="clearCanvas()">Clear</button>
  </div>

  <canvas id="mapCanvas" width="1086" height="768"></canvas>

  <script>
    const canvas = document.getElementById('mapCanvas');
    const ctx = canvas.getContext('2d');
    const radiusInput = document.getElementById('radiusInput');
    const colorSelect = document.getElementById('colorSelect');
    const modeSelect = document.getElementById('modeSelect');

    const img = new Image();
    img.src = 'kew-map.jpg'; // Ensure this image exists
    img.onload = () => ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

    const pixelsPerMeter = 29 / 50; // â‰ˆ 3.84 pixels per meter

    let lineStart = null;

    canvas.addEventListener('click', function(event) {
      const rect = canvas.getBoundingClientRect();
      const x = event.clientX - rect.left;
      const y = event.clientY - rect.top;
      const color = colorSelect.value;
      const mode = modeSelect.value;

      if (mode === 'circle') {
        const radiusMeters = parseFloat(radiusInput.value);
        const radiusPixels = radiusMeters * pixelsPerMeter;
        drawShadedCircle(x, y, radiusPixels, color);
      } else if (mode === 'line') {
        if (!lineStart) {
          lineStart = { x, y };
        } else {
          drawLine(lineStart.x, lineStart.y, x, y, color);
          lineStart = null; // reset for next line
        }
      }
    });

    function drawShadedCircle(x, y, r, color) {
      ctx.beginPath();
      ctx.arc(x, y, r, 0, 2 * Math.PI);
      ctx.fillStyle = color === 'green' ? 'rgba(0, 200, 0, 0.3)' : 'rgba(200, 0, 0, 0.3)';
      ctx.fill();
      ctx.strokeStyle = color === 'green' ? 'rgba(0, 200, 0, 0.8)' : 'rgba(200, 0, 0, 0.8)';
      ctx.lineWidth = 2;
      ctx.stroke();
    }

    function drawLine(x1, y1, x2, y2, color) {
      ctx.beginPath();
      ctx.moveTo(x1, y1);
      ctx.lineTo(x2, y2);
      ctx.strokeStyle = color === 'green' ? 'rgba(0, 200, 0, 0.8)' : 'rgba(200, 0, 0, 0.8)';
      ctx.lineWidth = 2;
      ctx.stroke();
    }

    function clearCanvas() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
      lineStart = null;
    }
  </script>
</body>
</html>
